---
import Layout from "../../layouts/Layout.astro";
import type Combos from "../../interfaces/combos.ts";
import Image from "astro/components/Image.astro";

// Dữ liệu mẫu thay thế cho API
const Combos: Combos[] = [
  {
    id: 1,
    attributes: {
      tilte: "Combo On-Grid 5kW 1 pha",
      nhom_combo: "On-Grid",
      he: "On-Grid",
      pha: "1 pha",
      cong_suat: "5",
      slug: "on-grid-5kw-1pha",
      gia_niem_yet: 65000000,
      san_luong: "500-600",
      hoan_von: "4-5 năm",
      dien_tich: "25",
      createdAt: "2023-01-15T08:00:00.000Z",
      updatedAt: "2023-05-20T10:30:00.000Z",
      publishedAt: "2023-01-20T09:00:00.000Z",
      category: "on-grid",
      image: {
        data: {
          id: 1,
          attributes: {
            name: "on-grid-image.jpg",
            url: "/images/combo-ongrid.jpg",
            formats: {
              medium: { url: "/images/combo-ongrid.jpg" },
              small: { url: "/images/combo-ongrid.jpg" },
              large: { url: "/images/combo-ongrid.jpg" }
            }
          }
        }
      }
    }
  },
  {
    id: 2,
    attributes: {
      tilte: "Combo Off-Grid 3kW 1 pha",
      nhom_combo: "Off-Grid",
      he: "Off-Grid",
      pha: "1 pha",
      cong_suat: "3",
      slug: "off-grid-3kw-1pha",
      gia_niem_yet: 75000000,
      san_luong: "300-400",
      hoan_von: "5-6 năm",
      dien_tich: "15",
      createdAt: "2023-02-10T08:30:00.000Z",
      updatedAt: "2023-06-15T11:20:00.000Z",
      publishedAt: "2023-02-15T09:15:00.000Z",
      category: "off-grid",
      image: {
        data: {
          id: 2,
          attributes: {
            name: "off-grid-image.jpg",
            url: "/images/combo-offgrid.jpg",
            formats: {
              medium: { url: "/images/combo-offgrid.jpg" },
              small: { url: "/images/combo-offgrid.jpg" },
              large: { url: "/images/combo-offgrid.jpg" }
            }
          }
        }
      }
    }
  },
  {
    id: 3,
    attributes: {
      tilte: "Combo On-Grid 10kW 3 pha",
      nhom_combo: "On-Grid",
      he: "On-Grid",
      pha: "3 pha",
      cong_suat: "10",
      slug: "on-grid-10kw-3pha",
      gia_niem_yet: 120000000,
      san_luong: "1000-1200",
      hoan_von: "3-4 năm",
      dien_tich: "50",
      createdAt: "2023-03-05T09:10:00.000Z",
      updatedAt: "2023-07-10T14:25:00.000Z",
      publishedAt: "2023-03-10T10:00:00.000Z",
      category: "on-grid",
      image: {
        data: {
          id: 3,
          attributes: {
            name: "on-grid-3pha-image.jpg",
            url: "/images/combo-ongrid-3pha.jpg",
            formats: {
              medium: { url: "/images/combo-ongrid-3pha.jpg" },
              small: { url: "/images/combo-ongrid-3pha.jpg" },
              large: { url: "/images/combo-ongrid-3pha.jpg" }
            }
          }
        }
      }
    }
  },
  {
    id: 4,
    attributes: {
      tilte: "Combo Off-Grid 8kW 3 pha áp thấp",
      nhom_combo: "Off-Grid",
      he: "Off-Grid",
      pha: "3 pha áp thấp",
      cong_suat: "8",
      slug: "off-grid-8kw-3pha-ap-thap",
      gia_niem_yet: 150000000,
      san_luong: "800-900",
      hoan_von: "6-7 năm",
      dien_tich: "40",
      createdAt: "2023-04-12T10:45:00.000Z",
      updatedAt: "2023-08-05T16:15:00.000Z",
      publishedAt: "2023-04-15T11:30:00.000Z", 
      category: "off-grid",
      image: {
        data: {
          id: 4,
          attributes: {
            name: "off-grid-3pha-image.jpg",
            url: "/images/combo-offgrid-3pha.jpg",
            formats: {
              medium: { url: "/images/combo-offgrid-3pha.jpg" },
              small: { url: "/images/combo-offgrid-3pha.jpg" },
              large: { url: "/images/combo-offgrid-3pha.jpg" }
            }
          }
        }
      }
    }
  }
];

const getCurrentMonthYear = () => {
  const date = new Date();
  const month = date.getMonth() + 1; // getMonth() returns 0-11, so add 1 for 1-12
  const year = date.getFullYear();
  return { month, year };
};

const { month, year } = getCurrentMonthYear();

const formatCurrency = (amount: any) => {
  return amount.toLocaleString("vi-VN");
};
---

<Layout title="Gói Combos">
  <div class="bg-slate-100">
    <div class="pt-6 py-4">
      <div class="mx-auto container px-6 lg:px-8">
        <ul
          role="list"
          class="mx-auto mt-6 grid max-w-2xl grid-cols-1 xl:gap-4 gap-8 md:max-w-2xl md:grid-cols-2 lg:max-w-4xl xl:mx-0 xl:max-w-none xl:grid-cols-4"
        >
          {
            Combos.map((combo) => (
              <div>
                <li class="rounded-2xl bg-white xl:px-4 xl:py-4 px-4 py-4">
                  <ul role="list" class="my-4 flex justify-between gap-x-2">
                    <li>
                      <ul role="list" class=" flex justify-between gap-x-1 ">
                        <li>
                          <a href="#" target="_blank" rel="noopener noreferrer">
                            <button
                              type="button"
                              class={`inline-flex text-white ${combo.attributes.nhom_combo === "On-Grid" ? "bg-red-600" : combo.attributes.nhom_combo === "Off-Grid" ? "bg-green-600" : "bg-gray-600"} items-center gap-x-1.5 rounded-lg px-2.5 py-1.5 xl:text-sm text-md font-semibold shadow-sm hover:${combo.attributes.nhom_combo === "On-Grid" ? "bg-red-600" : combo.attributes.nhom_combo === "Off-Grid" ? "bg-green-600" : "bg-gray-600"} focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-${combo.attributes.nhom_combo === "On-Grid" ? "red-600" : combo.attributes.nhom_combo === "Off-Grid" ? "green-600" : "gray-600"}`}
                            >
                              {combo.attributes.nhom_combo}
                            </button>
                          </a>
                        </li>
                        <li>
                          <a href="#" target="_blank" rel="noopener noreferrer">
                            <button
                              type="button"
                              class={`inline-flex items-center gap-x-1.5 rounded-lg px-2.5 py-1.5 xl:text-sm text-md font-semibold text-white shadow-sm ${
                                combo.attributes.pha === "1 pha"
                                  ? "bg-blue-600 hover:bg-blue-600 focus-visible:outline-blue-600"
                                  : combo.attributes.pha === "3 pha" ||
                                      combo.attributes.pha === "3 pha áp thấp"
                                    ? "bg-orange-500 hover:bg-orange-500 focus-visible:outline-orange-600"
                                    : combo.attributes.pha === "3 pha áp cao"
                                      ? "bg-red-500 hover:bg-red-500 focus-visible:outline-red-600"
                                      : "bg-gray-600 hover:bg-gray-600 focus-visible:outline-gray-600"
                              } focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2`}
                            >
                              {combo.attributes.pha}
                            </button>
                          </a>
                        </li>
                      </ul>
                    </li>
                    <li>
                      <a href="#" target="_blank" rel="noopener noreferrer">
                        <button
                          type="button"
                          class="  px-2.5 py-1.5 xl:text-xl text-xl font-semibold "
                        >
                          {combo.attributes.cong_suat} kW
                        </button>
                      </a>
                    </li>
                  </ul>
                  <a href={`/goi-san-pham/${combo.attributes.slug}/`}>
                    <img
                      class="rounded-2xl mx-auto aspect-[265/200] w-full object-cover"
                      src={combo.attributes.image.data.attributes.url}
                      alt={combo.attributes.tilte}
                    />
                  </a>

                  <div class=" w-full bg-slate-100 px-6 my-6 rounded-2xl  text-center  py-1.5   ">
                    <span>
                      Giá niêm yết T{month}/{year}
                    </span>
                    <h3
                      class={`text-3xl font-semibold ${
                        combo.attributes.nhom_combo === "On-Grid"
                          ? "text-red-600"
                          : combo.attributes.nhom_combo === "Off-Grid"
                            ? "text-green-600"
                            : "text-gray-600"
                      }`}
                    >
                      {formatCurrency(combo.attributes.gia_niem_yet)}
                      <sup>đ</sup>
                    </h3>
                  </div>
                  <div class="divide-y divide-gray-100 text-sm leading-6">
                    <ul role="list" class="mt-2 flex justify-between gap-x-6 ">
                      <li>
                        <h3 class="xl:text-lg text-xl font-semibold leading-7 tracking-tight ">
                          Công suất:
                        </h3>
                      </li>
                      <li>
                        <p class="xl:text-lg text-xl font-semibold leading-6 ">
                          {combo.attributes.cong_suat} kW
                        </p>
                      </li>
                    </ul>
                    <ul role="list" class="mt-2 flex justify-between gap-x-6">
                      <li>
                        <h3 class="xl:text-lg text-xl font-semibold leading-7 tracking-tight ">
                          Hệ điện:
                        </h3>
                      </li>
                      <li>
                        <p class="xl:text-lg text-xl leading-6 ">
                          {combo.attributes.pha}
                        </p>
                      </li>
                    </ul>
                    <ul role="list" class="mt-2 flex justify-between gap-x-6">
                      <li>
                        <h3 class="xl:text-lg text-xl text-nowrap font-semibold leading-7 tracking-tight ">
                          Sản lượng:
                        </h3>
                      </li>
                      <li>
                        <p class="xl:text-lg text-xl text-right leading-6 ">
                          {combo.attributes.san_luong}
                          <br />
                          kwh/tháng
                        </p>
                      </li>
                    </ul>
                    <ul role="list" class="mt-2 flex justify-between gap-x-6">
                      <li>
                        <h3 class="xl:text-lg text-xl font-semibold leading-7 tracking-tight ">
                          Hoàn vốn:
                        </h3>
                      </li>
                      <li>
                        <p class="xl:text-lg text-xl leading-6 ">
                          {combo.attributes.hoan_von}
                        </p>
                      </li>
                    </ul>
                    <ul role="list" class="mt-2 flex justify-between gap-x-6">
                      <li>
                        <h3 class="xl:text-lg text-xl font-semibold leading-7 tracking-tight ">
                          Diện tích lắp đặt:
                        </h3>
                      </li>
                      <li>
                        <p class=" xl:text-lg text-xl leading-6 ">
                          {combo.attributes.dien_tich} m<sup>2</sup>
                        </p>
                      </li>
                    </ul>
                  </div>
                  <ul role="list" class="mt-6 flex justify-between  gap-x-3">
                    <li class="w-2/3">
                      <a href={`/goi-san-pham/${combo.attributes.slug}/`}>
                        <button
                          type="button"
                          class={`w-full xl:text-lg inline-flex  ${
                            combo.attributes.nhom_combo === "On-Grid"
                              ? "bg-white border-red-600 text-red-600"
                              : combo.attributes.nhom_combo === "Off-Grid"
                                ? "bg-white border-green-600 text-green-600"
                                : "bg-gray-600 border-gray-600"
                          } items-center gap-x-1.5 rounded-xl border-2 px-2.5 py-1.5 text-lg font-semibold justify-center`}
                        >
                          Chi tiết cấu hình
                        </button>
                      </a>
                    </li>
                    <li class="w-1/3">
                      <a href="https://zalo.me/0964920242" target="_blank">
                        <button
                          type="button"
                          class={`w-full xl:text-lg inline-flex items-center gap-x-1.5 rounded-xl border-2 px-2.5 py-1.5 text-lg font-semibold text-white justify-center ${
                            combo.attributes.nhom_combo === "On-Grid"
                              ? "bg-red-600 border-red-600"
                              : combo.attributes.nhom_combo === "Off-Grid"
                                ? "bg-green-600 border-green-600"
                                : "bg-gray-600 border-gray-600"
                          }`}
                        >
                          Liên hệ
                        </button>
                      </a>
                    </li>
                  </ul>
                </li>
              </div>
            ))
          }
        </ul>
      </div>
    </div>
  </div>
</Layout>
